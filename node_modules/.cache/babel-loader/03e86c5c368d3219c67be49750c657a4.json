{"remainingRequest":"D:\\0毕设相关\\EAvLMS\\node_modules\\babel-loader\\lib\\index.js!D:\\0毕设相关\\EAvLMS\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\0毕设相关\\EAvLMS\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\0毕设相关\\EAvLMS\\src\\layout\\components\\Navbar.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\0毕设相关\\EAvLMS\\src\\layout\\components\\Navbar.vue","mtime":1590745008966},{"path":"D:\\0毕设相关\\EAvLMS\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\0毕设相关\\EAvLMS\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\0毕设相关\\EAvLMS\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\0毕设相关\\EAvLMS\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\"use strict\";\n\nvar _interopRequireDefault = require(\"D:\\\\0\\u6BD5\\u8BBE\\u76F8\\u5173\\\\EAvLMS\\\\node_modules\\\\@babel\\\\runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nrequire(\"core-js/modules/es6.regexp.replace\");\n\nvar _objectSpread2 = _interopRequireDefault(require(\"D:\\\\0\\u6BD5\\u8BBE\\u76F8\\u5173\\\\EAvLMS\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/objectSpread2\"));\n\nvar _vuex = require(\"vuex\");\n\nvar _Breadcrumb = _interopRequireDefault(require(\"@/components/Breadcrumb\"));\n\nvar _Hamburger = _interopRequireDefault(require(\"@/components/Hamburger\"));\n\nvar _Badge = _interopRequireDefault(require(\"@/components/Badge\"));\n\nvar _websocket = _interopRequireDefault(require(\"../../utils/websocket\"));\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nvar _default = {\n  components: {\n    Breadcrumb: _Breadcrumb.default,\n    Hamburger: _Hamburger.default,\n    Badge: _Badge.default\n  },\n  computed: (0, _objectSpread2.default)({}, (0, _vuex.mapGetters)(['sidebar', 'avatar'])),\n  data: function data() {\n    return {\n      //消息数量\n      noticeLength: 0\n    };\n  },\n  created: function created() {\n    var _this = this;\n\n    _websocket.default.init(this.onMessage); //加载提示音\n\n\n    this.audio = new Audio(require(\"../../assets/audio/msg.mp3\"));\n    this.audio.volume = 1; //音量，取值范围 0.1 到 1.0\n\n    var notice = JSON.parse(sessionStorage.getItem('notice'));\n    this.noticeLength = notice && notice.length || 0; //消息注册监听 对document对象新增一个监听\n\n    document.addEventListener('readMessage', function (e) {\n      //e是notice的自定义监听封装成的detail对象 里面暂时只有detail一个数据 可扩展\n      _this.noticeLength = e.detail;\n    });\n  },\n  methods: {\n    toggleSideBar: function toggleSideBar() {\n      this.$store.dispatch('app/toggleSideBar');\n    },\n    logout: function logout() {\n      //退出前清除用户信息\n      sessionStorage.removeItem('user');\n      sessionStorage.removeItem('routes');\n      this.$router.replace(\"/login\");\n    },\n    //点击消息提示图标进入消息列表\n    toNoticePage: function toNoticePage() {\n      this.$router.push('/notice');\n    },\n    //前端socket.onmessage 接收后端数据 然后回调onmessage函数展示\n    onMessage: function onMessage(data) {\n      this.$notify.warning({\n        title: '您有新的消息',\n        offset: 40,\n        dangerouslyUseHTMLString: true,\n        message: data.message\n      }); //播放提示音\n\n      this.audio.play();\n      var oldNotice = sessionStorage.getItem('notice'); //用户还未读的消息取出赋给oldNotice\n      //当oldNotice不为空并且解析oldNotice为对象也不为空（true），返回JSON.parse(oldNotice)的值，当前面两个判断有一个为空值返回[]数组\n\n      oldNotice = oldNotice && JSON.parse(oldNotice) || [];\n      oldNotice.push(data); //将新的消息添加进旧消息里\n\n      sessionStorage.setItem('notice', JSON.stringify(oldNotice)); //更新sessionstore里的notice\n\n      this.noticeLength = oldNotice.length;\n    }\n  }\n};\nexports.default = _default;",null]}